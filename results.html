<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>ðŸ“‹ Ergebnisse & Bearbeitung</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 2rem auto; padding: 1rem; color: #333; }
    h2 { font-size: 1.5rem; margin-bottom: 1rem; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    th { background: #f4f4f4; }
    input, button { font-size: 1rem; padding: 0.5rem; margin: 0.5rem 0; }
    button { cursor: pointer; background: #007ACC; color: #fff; border: none; border-radius: 4px; }
    input[type="text"] { width: calc(100% - 1rem); box-sizing: border-box; }
  </style>
</head>
<body>
  <h2>ðŸ“‹ Schnitzeljagd Ergebnisse</h2>
  <table id="resultsTable">
    <thead>
      <tr><th>Name</th><th>Zeit</th><th>Aktion</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Neuen Eintrag hinzufÃ¼gen / bearbeiten</h3>
  <form id="editForm">
    <label>Index: <input type="number" id="entryIndex" min="0" placeholder="0 fÃ¼r neuen Eintrag"></label><br>
    <label>Name: <input type="text" id="editName" placeholder="Pseudonym oder Name"></label><br>
    <label>Zeit: <input type="text" id="editTime" placeholder="z.Â B. 5mÂ 30s"></label><br>
    <button type="submit">Speichern</button>
  </form>

  <script>
    // Lade und zeige gespeicherte Scores
    let scores = JSON.parse(localStorage.getItem('duelken_scores') || '[]');
    const tbody = document.querySelector('#resultsTable tbody');
    const form = document.getElementById('editForm');
    const idxInput = document.getElementById('entryIndex');
    const nameInput = document.getElementById('editName');
    const timeInput = document.getElementById('editTime');

    function render() {
      tbody.innerHTML = '';
      scores.forEach((e, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${e.name}</td>
          <td>${e.time}</td>
          <td><button data-index="${i}" class="editBtn">Bearbeiten</button> <button data-index="${i}" class="delBtn">LÃ¶schen</button></td>
        `;
        tbody.appendChild(tr);
      });
      attachButtons();
    }

    function attachButtons() {
      document.querySelectorAll('.editBtn').forEach(btn => {
        btn.onclick = () => {
          const i = btn.dataset.index;
          idxInput.value = i;
          nameInput.value = scores[i].name;
          timeInput.value = scores[i].time;
        };
      });
      document.querySelectorAll('.delBtn').forEach(btn => {
        btn.onclick = () => {
          scores.splice(btn.dataset.index, 1);
          localStorage.setItem('duelken_scores', JSON.stringify(scores));
          render();
        };
      });
    }

    form.onsubmit = e => {
      e.preventDefault();
      const i = parseInt(idxInput.value);
      const entry = { name: nameInput.value.trim() || '-', time: timeInput.value.trim() };
      if (!entry.time) return;
      if (!isNaN(i) && i >= 0 && i < scores.length) {
        scores[i] = entry;
      } else {
        scores.push(entry);
      }
      localStorage.setItem('duelken_scores', JSON.stringify(scores));
      form.reset();
      render();
    };

    render();
  </script>
</body>
</html>
