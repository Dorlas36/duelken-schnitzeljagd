<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>üéÅ Finale</title>
  <style>
    body { background:#f1f8e9; font-family:'Comic Sans MS',sans-serif; max-width:600px; margin:2rem auto; padding:1rem; color:#33691e; }
    h1 { text-align:center; color:#558b2f; font-size:2rem; }
    #timeDisplay { font-size:1.2rem; margin:1rem 0; }
    form, input, button { width:100%; font-size:1.1rem; margin:.5rem 0; border-radius:8px; box-sizing:border-box; }
    input { padding:.8rem; border:2px solid #aed581; }
    button { padding:.8rem; background:#aed581; color:white; border:none; cursor:pointer; }
    table { width:100%; border-collapse:collapse; margin-top:1rem; }
    th, td { border:1px solid #33691e; padding:.5rem; text-align:left; }
    th { background:#c5e1a5; }
  </style>
</head>
<body>
  <h1>üéÅ Finale</h1>
  <div id="timeDisplay">Deine Zeit: ‚Ä¶</div>

  <form id="scoreForm">
    <input type="text" id="playerName" placeholder="Dein Name (optional)">
    <button type="submit">Eintragen (freiwillig)</button>
  </form>

  <table id="resultsTable">
    <thead>
      <tr><th>Name</th><th>Zeit</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const timerEnabled = localStorage.getItem('duelken_timerEnabled') === 'true';
    const startTime = timerEnabled ? parseInt(localStorage.getItem('duelken_startTime'),10) : null;
    const diff = timerEnabled ? Date.now() - startTime : 0;
    const mins = Math.floor(diff/60000), secs = Math.floor((diff%60000)/1000);
    const timeStr = timerEnabled ? `${mins}m ${secs}s` : '‚Äì';
    document.getElementById('timeDisplay').textContent = `Deine Zeit: ${timeStr}`;

    const tbody = document.querySelector('#resultsTable tbody');
    function render() {
      const scores = JSON.parse(localStorage.getItem('duelken_scores')||'[]');
      tbody.innerHTML = '';
      scores.forEach(e=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${e.name}</td><td>${e.time}</td>`;
        tbody.appendChild(tr);
      });
    }
    render();

    document.getElementById('scoreForm').onsubmit = e => {
      e.preventDefault();
      if (!timerEnabled) {
        alert('Timer war nicht aktiviert ‚Äì kein Eintrag m√∂glich.');
        return;
      }
      const n = document.getElementById('playerName').value.trim() || '-';
      const scores = JSON.parse(localStorage.getItem('duelken_scores')||'[]');
      scores.push({name:n, time: timeStr});
      localStorage.setItem('duelken_scores', JSON.stringify(scores));
      document.getElementById('playerName').value = '';
      render();
      alert('Danke, dein Eintrag ist gespeichert!');
    };
  </script>
</body>
</html>
